Search.setIndex({docnames:["clip","index","install","quickstart","slurm","trak"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["clip.rst","index.rst","install.rst","quickstart.rst","slurm.rst","trak.rst"],objects:{"":[[5,0,0,"-","trak"]],"trak.gradient_computers":[[5,1,1,"","AbstractGradientComputer"],[5,1,1,"","FunctionalGradientComputer"],[5,1,1,"","IterativeGradientComputer"]],"trak.gradient_computers.AbstractGradientComputer":[[5,2,1,"","compute_loss_grad"],[5,2,1,"","compute_per_sample_grad"],[5,3,1,"","is_functional"],[5,2,1,"","load_model_params"]],"trak.gradient_computers.FunctionalGradientComputer":[[5,2,1,"","compute_loss_grad"],[5,2,1,"","compute_per_sample_grad"],[5,2,1,"","load_model_params"]],"trak.gradient_computers.IterativeGradientComputer":[[5,2,1,"","compute_loss_grad"],[5,2,1,"","compute_per_sample_grad"],[5,3,1,"","is_functional"],[5,2,1,"","load_model_params"]],"trak.modelout_functions":[[5,1,1,"","AbstractModelOutput"],[5,1,1,"","CLIPModelOutput"],[5,1,1,"","ImageClassificationModelOutput"],[5,1,1,"","IterImageClassificationModelOutput"]],"trak.modelout_functions.AbstractModelOutput":[[5,2,1,"","get_out_to_loss_grad"],[5,2,1,"","get_output"]],"trak.modelout_functions.CLIPModelOutput":[[5,2,1,"","get_embeddings"],[5,2,1,"","get_out_to_loss_grad"],[5,2,1,"","get_output"],[5,3,1,"","image_embeddings"],[5,3,1,"","num_computed_embeddings"],[5,3,1,"","sim_batch_size"],[5,3,1,"","text_embeddings"]],"trak.modelout_functions.ImageClassificationModelOutput":[[5,2,1,"","forward"],[5,2,1,"","get_out_to_loss_grad"],[5,2,1,"","get_output"]],"trak.modelout_functions.IterImageClassificationModelOutput":[[5,2,1,"","get_out_to_loss_grad"],[5,2,1,"","get_output"]],"trak.projectors":[[5,1,1,"","AbstractProjector"],[5,1,1,"","BasicProjector"],[5,1,1,"","BasicSingleBlockProjector"],[5,1,1,"","CudaProjector"],[5,1,1,"","ProjectionType"]],"trak.projectors.AbstractProjector":[[5,2,1,"","project"]],"trak.projectors.BasicProjector":[[5,2,1,"","generate_sketch_matrix"],[5,2,1,"","get_generator_states"],[5,2,1,"","project"]],"trak.projectors.BasicSingleBlockProjector":[[5,2,1,"","generate_sketch_matrix"],[5,2,1,"","project"]],"trak.projectors.CudaProjector":[[5,2,1,"","project"]],"trak.projectors.ProjectionType":[[5,3,1,"","normal"],[5,3,1,"","rademacher"]],"trak.savers":[[5,1,1,"","AbstractSaver"],[5,1,1,"","MmapSaver"],[5,4,1,"","ModelIDException"]],"trak.savers.AbstractSaver":[[5,2,1,"","clear_target_grad_count"],[5,2,1,"","del_grads"],[5,2,1,"","load_store"],[5,2,1,"","load_target_store"],[5,2,1,"","register_model_id"],[5,2,1,"","serialize_model_id_metadata"]],"trak.savers.MmapSaver":[[5,2,1,"","clear_target_grad_count"],[5,2,1,"","del_grads"],[5,2,1,"","init_store"],[5,2,1,"","load_store"],[5,2,1,"","load_target_store"],[5,2,1,"","register_model_id"],[5,2,1,"","save_scores"],[5,2,1,"","serialize_model_id_metadata"]],"trak.score_computers":[[5,1,1,"","AbstractScoreComputer"],[5,1,1,"","BasicScoreComputer"],[5,1,1,"","BasicSingleBlockScoreComputer"]],"trak.score_computers.AbstractScoreComputer":[[5,2,1,"","get_scores"],[5,2,1,"","get_x_xtx_inv"],[5,2,1,"","get_xtx"]],"trak.score_computers.BasicScoreComputer":[[5,2,1,"","get_scores"],[5,2,1,"","get_x_xtx_inv"],[5,2,1,"","get_xtx"]],"trak.score_computers.BasicSingleBlockScoreComputer":[[5,2,1,"","get_scores"],[5,2,1,"","get_x_xtx_inv"],[5,2,1,"","get_xtx"]],"trak.traker":[[5,1,1,"","TRAKer"]],"trak.traker.TRAKer":[[5,2,1,"","featurize"],[5,2,1,"","finalize_features"],[5,2,1,"","finalize_scores"],[5,2,1,"","init_projector"],[5,2,1,"","load_checkpoint"],[5,2,1,"","score"],[5,2,1,"","start_scoring_checkpoint"]],"trak.utils":[[5,5,1,"","get_num_params"],[5,5,1,"","get_params_dict"],[5,5,1,"","is_not_buffer"],[5,5,1,"","parameters_to_vector"],[5,5,1,"","vectorize_and_ignore_buffers"]],trak:[[5,0,0,"-","gradient_computers"],[5,0,0,"-","modelout_functions"],[5,0,0,"-","projectors"],[5,0,0,"-","savers"],[5,0,0,"-","score_computers"],[5,0,0,"-","traker"],[5,0,0,"-","utils"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","exception","Python exception"],"5":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:exception","5":"py:function"},terms:{"0":[1,2,4,5],"1":[2,4,5],"10":[2,4],"100":5,"100000":5,"1024":5,"11":2,"12":2,"14":4,"2":5,"200":5,"2048":5,"3":5,"300":5,"4":5,"5":[2,5],"50000":5,"50_000":5,"64":[],"7":[2,5],"8":4,"9":4,"abstract":5,"break":5,"case":2,"class":5,"default":[2,4,5],"do":[4,5],"enum":5,"export":2,"final":[4,5],"float":5,"function":5,"import":4,"int":[4,5],"new":5,"return":5,"static":5,"true":[4,5],A:5,At:[],For:[2,4,5],If:[2,5],In:5,It:5,On:2,Or:[],That:4,The:[2,4,5],These:5,To:[2,4],_:5,__main__:4,__name__:4,_allow_featurizing_already_regist:5,_description_:5,_summary_:5,a100:[4,5],abc:5,about:[4,5],abov:[4,5],abstractgradientcomput:5,abstractmodeloutput:5,abstractprojector:5,abstractsav:5,abstractscorecomput:5,accumul:5,achiev:4,across:[4,5],action:[],activ:1,ad:5,add:2,add_argu:4,addit:5,addition:5,all:[4,5],allow:5,almost:5,alon:5,along:5,alongsid:2,alreadi:[2,5],also:5,an:[2,5],analyt:5,ani:5,anyth:5,appli:5,applic:5,apt:2,ar:[1,2,5],arg:[4,5],argpars:4,argumentpars:4,arrai:[4,5],assertionerror:5,associ:5,attempt:4,attribut:5,autograd:5,avail:[2,5],avoid:5,b:5,backward:5,bare:5,base:5,bash:4,basicprojector:5,basicscorecomput:5,basicsingleblockprojector:5,basicsingleblockscorecomput:5,batch:[4,5],batch_siz:5,been:2,befor:[2,5],behavior:5,behaviour:5,behind:4,below:[2,4],big:5,bin:4,block:5,block_siz:5,bone:5,bool:5,both:5,buffer:5,c:[2,5],call:[4,5],can:[2,4,5],cannot:5,capabl:5,caption:5,cc:2,cdot:5,chang:1,check:[2,4,5],checkpoint:[4,5],checopint:[],choic:5,chosen:5,cifar10:[],ckpt:4,ckpt_:4,classif:5,clear_target_grad_count:5,clip:[1,5],clipmodeloutput:5,cluster:2,coda:[],code:4,com:[2,5],combin:4,come:2,command:[2,4],comment:[],commit:5,compani:2,compat:[2,5],compil:2,comput:[4,5],compute_loss_grad:5,compute_per_sample_grad:5,conda:2,confid:2,configur:2,confus:5,consid:5,contain:2,content:1,context:5,contrast:5,copi:4,correct:5,count:5,cpu:4,crawler:[],creat:5,cuda:[1,5],cuda_max_dim_s:5,cudaprojector:5,cudatoolkit:2,current:4,current_:5,custom:[2,5],cxx:2,data:5,dataload:[],dataset:[],def:4,definit:4,del_grad:5,delet:5,deriv:5,desc:[],design:[4,5],desir:5,detail:[4,5],determin:5,dev:2,develop:[1,5],devic:5,diagon:5,dict:5,dictionari:5,differ:5,dimens:5,dimension:5,dir:5,disk:5,distribut:4,doc:[2,4,5],document:2,doe:5,doesn:5,don:[4,5],done:2,doubt:2,download:2,ds_train:4,ds_val:[],dtype:5,dure:5,e:[4,5],each:[4,5],eas:4,easy_instal:[],either:5,ell:5,embed:5,embedding_dim:5,enabl:[2,5],end:4,entir:5,entri:5,enumer:5,equival:5,error:5,etc:5,eval:[],even:5,everi:5,everyth:4,exampl:[1,2,4,5],except:5,exist:[2,5],exmapl:4,exp_nam:5,f:[4,5],fals:5,faq:1,fast:2,faster:5,feasibl:5,featur:[4,5],featurize_and_scor:4,feel:[2,5],file:[4,5],finalize_featur:[4,5],finalize_scor:[4,5],find:4,fix:5,flatten:5,float16:5,float32:5,follow:[2,5],footprint:5,forbidden:5,forg:2,forward:5,four:[],frac:5,free:5,from:[4,5],func:5,func_model:5,functionalgradientcomput:5,functorch:5,g:[2,4,5],gather:4,gcc:1,gcc_linux:[],gener:5,generate_sketch_matrix:5,generator_st:5,get:4,get_embed:5,get_generator_st:5,get_num_param:5,get_out_to_loss_grad:5,get_output:5,get_params_dict:5,get_scor:5,get_x_xtx_inv:5,get_xtx:5,getter:5,given:5,gnu:[],go:4,good:5,gpu:[4,5],grad:5,grad_dim:5,grad_out_to_loss:5,grad_w0:5,grad_w1:5,grad_wi:5,grad_wp:5,gradient:5,gradient_comput:1,gradientcomput:5,grads_shap:[],gre:4,guid:2,gxx_linux:[],ha:[2,5],handl:5,happen:2,hardcod:[],have:[2,4,5],help:4,henc:5,here:[2,4,5],heta:5,highli:4,highlight:4,host:2,how:[1,5],html:[2,5],http:[2,5],hyperparamet:5,i:5,id:[4,5],idea:4,imag:5,image_classif:4,image_embed:5,imageclassificationmodeloutput:5,implement:5,includ:5,incompat:2,ind:5,index:[1,2],indic:5,ineffici:5,init:5,init_projector:5,init_stor:5,initi:5,input:5,instal:1,instanc:4,instead:5,instruct:2,integr:4,intermedi:[4,5],intern:5,invok:5,is_funct:5,is_not_buff:5,iter:5,iterativegradientcomput:5,iterimageclassificationmodeloutput:5,its:5,jl:[2,5],job:4,johnson:5,kernel:2,kwarg:5,label:5,languag:5,larger:5,last:5,learn:[4,5],left:4,len:4,let:[2,5],leverag:[4,5],like:[4,5],lindenstrauss:5,line:4,link:5,linux:[],list:[2,5],littl:[],ll:[4,5],load:[2,4,5],load_checkpoint:[4,5],load_model_param:5,load_state_dict:5,load_stor:5,load_target_stor:5,loader:5,loader_train:4,loader_v:4,log:[2,5],logit:5,look:4,loss:5,lot:1,machin:2,mai:[1,2,4],main:4,maintain:2,make:5,make_functional_with_buff:5,mani:5,manner:5,map:5,margin:5,math:5,matmul:5,matric:5,matrix:5,maximum:5,mean:4,memmap:5,memori:5,metadata:5,method:[4,5],might:2,minim:5,mkvirtualenv:[],mmap:5,mmapsav:5,mode:5,model:[4,5],model_id:[4,5],model_out_to_loss:5,model_out_to_loss_grad:5,modelidexcept:5,modelout_fn:5,modelout_funct:1,modeloutput:[1,5],modeloutputfunct:[],modifi:5,modul:[1,2],modulefil:2,more:[4,5],most:[2,5],much:5,multiclass:5,multimod:5,multipl:4,must:5,n:5,nabla_:5,name:[4,5],need:[2,4,5],nn:5,node:4,none:5,normal:5,notat:5,note:[2,4,5],notebook:5,now:4,npy:5,num_computed_embed:5,num_param:5,num_sampl:5,num_target:5,number:5,numpi:5,nvcc:1,nvidia:[2,5],object:5,often:4,old:5,one:[2,5],onli:[4,5],oom:5,oper:2,option:[2,4,5],org:5,other:2,otherwis:5,our:[2,4,5],out:[4,5],out_to_loss:5,outdat:2,output:5,overal:4,overrid:5,p:5,packag:2,page:[],pair:5,paper:[4,5],parallel:1,paralleliz:4,paramet:5,parameters_to_vector:5,params_dict:5,parse_arg:4,parser:4,part:5,partial:5,particular:5,pass:[4,5],path:[4,5],pathlib:5,per:[4,5],per_sample_grad:5,perform:5,peski:5,phi:5,phi_c:5,pick:2,pip:2,pleas:5,plese:2,popul:[4,5],post:4,power:4,ppa:2,pr:5,predict:5,preinstal:2,prepar:5,preprocess_fn_img:5,preprocess_fn_txt:5,prioriti:4,probabl:5,problem:[4,5],proce:2,process:4,produc:5,proj_dim:5,proj_typ:5,project:[2,5],projectiontyp:5,projector:1,proper:[],provid:5,psi:5,pt:4,purpos:5,py:4,pypi:2,python:4,pytorch:5,q:5,quick:2,r:[2,5],rademach:5,rais:5,random:5,rang:5,re:5,read:5,reason:5,recommend:5,record:5,reduct:5,refer:[2,5],regard:2,regist:5,register_model_id:5,relat:5,replac:[],repositori:2,requir:[2,4,5],reset:5,reshap:5,resnet18:5,respect:[4,5],result:[4,5],reweight:5,root:2,run:[2,4,5],rune:2,s:[2,4,5],same:[2,4,5],sampl:5,save:5,save_dir:[4,5],save_scor:5,saver:1,sbatch:4,scalar:5,schedul:4,score:[1,5],score_comput:1,scorecomput:5,script:4,search:[],section:[2,5],see:[2,4,5],seed:5,self:5,sequenti:5,serial:5,serialize_model_id_metadata:5,set:5,setter:5,setup:2,shape:5,share:2,ship:2,should:[4,5],shouldn:5,show:2,shuffl:[],signatur:5,significantli:5,sim_batch_s:5,similar:5,simpl:[4,5],simpli:5,simul:5,simulated_batch_s:5,sinc:5,siu:[],size:5,sketch:4,skip:4,slightli:5,slower:5,slurm:1,slurm_array_task_id:4,slurm_example_result:[],small:5,so:5,softmax:5,some:[2,4],someth:5,sourc:5,specifi:[4,5],stabl:5,standard:2,start:[2,5],start_scoring_checkpoint:[4,5],state:5,state_dict:5,step:[2,5],still:1,store:5,str:5,strongli:5,structur:5,subclass:[1,5],submit:4,submodul:[],sudo:2,sum_:5,system:[2,4],t:[4,5],take:5,target:5,target_grad:5,task:[4,5],temperatur:5,tensor:5,term:5,termin:[2,4],test:[2,5],text:5,text_embed:5,than:5,thei:2,them:5,theta:5,thi:[2,4,5],thing:[1,4],think:[4,5],three:[4,5],thu:5,ti:5,time:2,tip:2,tmp:[],todo:5,togeth:5,tookit:2,toolchain:2,toolkit:1,top:5,torch:[4,5],torchvis:[],totensor:[],tqdm:[],train:[4,5],train_set_s:[4,5],trak:[],trak_result:5,traker:[1,2,4],transform:5,tupl:5,two:[],type:[4,5],ubuntu:2,under:1,union:5,uniqu:5,unless:5,unvers:2,up:4,updat:[2,5],us:[2,4,5],usual:2,util:1,uuid:5,valu:5,vector:5,vectorize_and_ignore_buff:5,veri:5,version:[1,2,5],view:5,virtualenvwrapp:[],vision:5,vmap:5,wa:4,wai:[2,4],want:5,we:[1,4,5],weight:5,well:5,what:[2,4,5],when:[2,4,5],where:5,whether:5,which:[2,5],why:4,wise:5,without:[2,5],would:4,write:[4,5],x86_64:[],x:[1,5],xtx:5,y:5,ye:5,you:[2,4,5],your:[2,5],z:5,z_i:5},titles:["Subclassing <code class=\"code docutils literal notranslate\"><span class=\"pre\">ModelOutput</span></code> \u2014 Example with CLIP","Welcome to TRAK\u2019s documentation!","Installation FAQs","&lt;no title&gt;","Parallelize <code class=\"code docutils literal notranslate\"><span class=\"pre\">TRAK</span></code> scoring with <code class=\"code docutils literal notranslate\"><span class=\"pre\">SLURM</span></code>","Modules"],titleterms:{"class":[],clip:0,content:5,cuda:2,document:1,exampl:0,faq:2,gcc:2,gradient_comput:5,how:2,index:[],indic:1,instal:2,intro:[],modelout_funct:5,modeloutput:0,modeloutputfunct:[],modul:5,nvcc:2,packag:[],parallel:4,projector:5,s:1,saver:5,score:4,score_comput:5,slurm:4,subclass:0,submodul:[],tabl:1,toolkit:2,trak:[1,2,4,5],traker:5,util:5,welcom:1}})