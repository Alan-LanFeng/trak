Search.setIndex({docnames:["index","modules","trak"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["index.rst","modules.rst","trak.rst"],objects:{"":[[2,0,0,"-","trak"]],"trak.gradient_computers":[[2,1,1,"","AbstractGradientComputer"],[2,1,1,"","FunctionalGradientComputer"],[2,1,1,"","IterativeGradientComputer"]],"trak.gradient_computers.AbstractGradientComputer":[[2,2,1,"","compute_loss_grad"],[2,2,1,"","compute_per_sample_grad"],[2,3,1,"","is_functional"],[2,2,1,"","load_model_params"]],"trak.gradient_computers.FunctionalGradientComputer":[[2,2,1,"","compute_loss_grad"],[2,2,1,"","compute_per_sample_grad"],[2,2,1,"","load_model_params"]],"trak.gradient_computers.IterativeGradientComputer":[[2,2,1,"","compute_loss_grad"],[2,2,1,"","compute_per_sample_grad"],[2,3,1,"","is_functional"],[2,2,1,"","load_model_params"]],"trak.modelout_functions":[[2,1,1,"","AbstractModelOutput"],[2,1,1,"","CLIPModelOutput"],[2,1,1,"","ImageClassificationModelOutput"],[2,1,1,"","IterImageClassificationModelOutput"]],"trak.modelout_functions.AbstractModelOutput":[[2,2,1,"","get_out_to_loss_grad"],[2,2,1,"","get_output"]],"trak.modelout_functions.CLIPModelOutput":[[2,2,1,"","get_embeddings"],[2,2,1,"","get_out_to_loss_grad"],[2,2,1,"","get_output"],[2,3,1,"","image_embeddings"],[2,3,1,"","num_computed_embeddings"],[2,3,1,"","sim_batch_size"],[2,3,1,"","text_embeddings"]],"trak.modelout_functions.ImageClassificationModelOutput":[[2,2,1,"","forward"],[2,2,1,"","get_out_to_loss_grad"],[2,2,1,"","get_output"]],"trak.modelout_functions.IterImageClassificationModelOutput":[[2,2,1,"","get_out_to_loss_grad"],[2,2,1,"","get_output"]],"trak.projectors":[[2,1,1,"","AbstractProjector"],[2,1,1,"","BasicProjector"],[2,1,1,"","BasicSingleBlockProjector"],[2,1,1,"","CudaProjector"],[2,1,1,"","ProjectionType"]],"trak.projectors.AbstractProjector":[[2,2,1,"","project"]],"trak.projectors.BasicProjector":[[2,2,1,"","generate_sketch_matrix"],[2,2,1,"","get_generator_states"],[2,2,1,"","project"]],"trak.projectors.BasicSingleBlockProjector":[[2,2,1,"","generate_sketch_matrix"],[2,2,1,"","project"]],"trak.projectors.CudaProjector":[[2,2,1,"","project"]],"trak.projectors.ProjectionType":[[2,3,1,"","normal"],[2,3,1,"","rademacher"]],"trak.savers":[[2,1,1,"","AbstractSaver"],[2,1,1,"","MmapSaver"],[2,4,1,"","ModelIDException"]],"trak.savers.AbstractSaver":[[2,2,1,"","clear_target_grad_count"],[2,2,1,"","del_grads"],[2,2,1,"","load_store"],[2,2,1,"","load_target_store"],[2,2,1,"","register_model_id"],[2,2,1,"","serialize_model_id_metadata"]],"trak.savers.MmapSaver":[[2,2,1,"","clear_target_grad_count"],[2,2,1,"","del_grads"],[2,2,1,"","init_store"],[2,2,1,"","load_store"],[2,2,1,"","load_target_store"],[2,2,1,"","register_model_id"],[2,2,1,"","save_scores"],[2,2,1,"","serialize_model_id_metadata"]],"trak.score_computers":[[2,1,1,"","AbstractScoreComputer"],[2,1,1,"","BasicScoreComputer"],[2,1,1,"","BasicSingleBlockScoreComputer"]],"trak.score_computers.AbstractScoreComputer":[[2,2,1,"","get_scores"],[2,2,1,"","get_x_xtx_inv"],[2,2,1,"","get_xtx"]],"trak.score_computers.BasicScoreComputer":[[2,2,1,"","get_scores"],[2,2,1,"","get_x_xtx_inv"],[2,2,1,"","get_xtx"]],"trak.score_computers.BasicSingleBlockScoreComputer":[[2,2,1,"","get_scores"],[2,2,1,"","get_x_xtx_inv"],[2,2,1,"","get_xtx"]],"trak.traker":[[2,1,1,"","TRAKer"]],"trak.traker.TRAKer":[[2,2,1,"","featurize"],[2,2,1,"","finalize_features"],[2,2,1,"","finalize_scores"],[2,2,1,"","init_projector"],[2,2,1,"","load_checkpoint"],[2,2,1,"","score"],[2,2,1,"","start_scoring_checkpoint"]],"trak.utils":[[2,5,1,"","get_num_params"],[2,5,1,"","get_params_dict"],[2,5,1,"","is_not_buffer"],[2,5,1,"","parameters_to_vector"],[2,5,1,"","vectorize_and_ignore_buffers"]],trak:[[2,0,0,"-","gradient_computers"],[2,0,0,"-","modelout_functions"],[2,0,0,"-","projectors"],[2,0,0,"-","savers"],[2,0,0,"-","score_computers"],[2,0,0,"-","traker"],[2,0,0,"-","utils"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","exception","Python exception"],"5":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:exception","5":"py:function"},terms:{"0":2,"1":2,"100":2,"100000":2,"1024":2,"2":2,"200":2,"2048":2,"3":2,"300":2,"4":2,"5":2,"50000":2,"50_000":2,"7":2,"abstract":2,"break":2,"class":2,"default":2,"do":2,"enum":2,"final":2,"float":2,"function":2,"int":2,"new":2,"return":2,"static":2,"true":2,A:2,For:2,If:2,In:2,It:2,The:2,These:2,_:2,_allow_featurizing_already_regist:2,_description_:2,_summary_:2,a100:2,abc:2,about:2,abov:2,abstractgradientcomput:2,abstractmodeloutput:2,abstractprojector:2,abstractsav:2,abstractscorecomput:2,accumul:2,across:2,ad:2,addit:2,addition:2,all:2,allow:2,almost:2,alon:2,along:2,alreadi:2,also:2,an:2,analyt:2,ani:2,anyth:2,appli:2,applic:2,ar:2,arg:2,arrai:2,assertionerror:2,associ:2,attribut:2,autograd:2,avail:2,avoid:2,b:2,backward:2,bare:2,base:2,basicprojector:2,basicscorecomput:2,basicsingleblockprojector:2,basicsingleblockscorecomput:2,batch:2,batch_siz:2,befor:2,behavior:2,behaviour:2,big:2,block:2,block_siz:2,bone:2,bool:2,both:2,buffer:2,c:2,call:2,can:2,cannot:2,capabl:2,caption:2,cdot:2,check:2,checkpoint:2,choic:2,chosen:2,classif:2,clear_target_grad_count:2,clip:2,clipmodeloutput:2,com:2,commit:2,compat:2,comput:2,compute_loss_grad:2,compute_per_sample_grad:2,confus:2,consid:2,content:1,context:2,contrast:2,correct:2,count:2,creat:2,cuda:2,cuda_max_dim_s:2,cudaprojector:2,current_:2,custom:2,data:2,del_grad:2,delet:2,deriv:2,design:2,desir:2,detail:2,determin:2,develop:2,devic:2,diagon:2,dict:2,dictionari:2,differ:2,dimens:2,dimension:2,dir:2,disk:2,doc:2,doe:2,doesn:2,don:2,dtype:2,dure:2,e:2,each:2,either:2,ell:2,embed:2,embedding_dim:2,enabl:2,entir:2,entri:2,enumer:2,equival:2,error:2,etc:2,even:2,everi:2,exampl:2,except:2,exist:2,exp_nam:2,f:2,fals:2,faster:2,feasibl:2,featur:2,feel:2,file:2,finalize_featur:2,finalize_scor:2,fix:2,flatten:2,float16:2,float32:2,follow:2,footprint:2,forbidden:2,forward:2,frac:2,free:2,from:2,func:2,func_model:2,functionalgradientcomput:2,functorch:2,g:2,gener:2,generate_sketch_matrix:2,generator_st:2,get_embed:2,get_generator_st:2,get_num_param:2,get_out_to_loss_grad:2,get_output:2,get_params_dict:2,get_scor:2,get_x_xtx_inv:2,get_xtx:2,getter:2,given:2,good:2,gpu:2,grad:2,grad_dim:2,grad_out_to_loss:2,grad_w0:2,grad_w1:2,grad_wi:2,grad_wp:2,gradient:2,gradient_comput:1,gradientcomput:2,grads_shap:2,ha:2,handl:2,have:2,henc:2,here:2,heta:2,how:2,html:2,http:2,hyperparamet:2,i:2,id:2,imag:2,image_embed:2,imageclassificationmodeloutput:2,implement:2,includ:2,ind:2,index:0,indic:2,ineffici:2,init:2,init_projector:2,init_stor:2,initi:2,input:2,instead:2,intermedi:2,intern:2,invok:2,is_funct:2,is_not_buff:2,iter:2,iterativegradientcomput:2,iterimageclassificationmodeloutput:2,its:2,jl:2,johnson:2,kwarg:2,label:2,languag:2,larger:2,last:2,learn:2,let:2,leverag:2,like:2,lindenstrauss:2,link:2,list:2,ll:2,load:2,load_checkpoint:2,load_model_param:2,load_state_dict:2,load_stor:2,load_target_stor:2,loader:2,log:2,logit:2,loss:2,make:2,make_functional_with_buff:2,mani:2,manner:2,map:2,margin:2,math:2,matmul:2,matric:2,matrix:2,maximum:2,memmap:2,memori:2,metadata:2,method:2,minim:2,mmap:2,mmapsav:2,mode:2,model:2,model_id:2,model_out_to_loss:2,model_out_to_loss_grad:2,modelidexcept:2,modelout_fn:2,modelout_funct:1,modeloutput:2,modifi:2,modul:[0,1],more:2,most:2,much:2,multiclass:2,multimod:2,must:2,n:2,nabla_:2,name:2,need:2,nn:2,none:2,normal:2,notat:2,note:2,notebook:2,npy:2,num_computed_embed:2,num_param:2,num_sampl:2,num_target:2,number:2,numpi:2,nvidia:2,object:2,old:2,one:2,onli:2,oom:2,option:2,org:2,otherwis:2,our:2,out:2,out_to_loss:2,output:2,overrid:2,p:2,packag:1,page:0,pair:2,paper:2,paramet:2,parameters_to_vector:2,params_dict:2,part:2,partial:2,particular:2,pass:2,path:2,pathlib:2,per:2,per_sample_grad:2,perform:2,peski:2,phi:2,phi_c:2,pleas:2,popul:2,pr:2,predict:2,prepar:2,preprocess_fn_img:2,preprocess_fn_txt:2,probabl:2,problem:2,produc:2,proj_dim:2,proj_typ:2,project:2,projectiontyp:2,projector:1,provid:2,psi:2,purpos:2,pytorch:2,q:2,r:2,rademach:2,rais:2,random:2,rang:2,re:2,read:2,reason:2,recommend:2,record:2,reduct:2,refer:2,regist:2,register_model_id:2,relat:2,requir:2,reset:2,reshap:2,resnet18:2,respect:2,result:2,reweight:2,run:2,s:2,same:2,sampl:2,save:2,save_dir:2,save_scor:2,saver:1,scalar:2,score:2,score_comput:1,scorecomput:2,search:0,section:2,see:2,seed:2,self:2,sequenti:2,serial:2,serialize_model_id_metadata:2,set:2,setter:2,shape:2,should:2,shouldn:2,signatur:2,significantli:2,sim_batch_s:2,similar:2,simpl:2,simpli:2,simul:2,simulated_batch_s:2,sinc:2,size:2,slightli:2,slower:2,small:2,so:2,softmax:2,someth:2,sourc:2,specifi:2,stabl:2,start:2,start_scoring_checkpoint:2,state:2,state_dict:2,step:2,store:2,str:2,strongli:2,structur:2,subclass:2,submodul:1,sum_:2,t:2,take:2,target:2,target_grad:2,task:2,temperatur:2,tensor:2,term:2,test:2,text:2,text_embed:2,than:2,them:2,theta:2,thi:2,think:2,three:2,thu:2,ti:2,todo:2,togeth:2,top:2,torch:2,train:2,train_set_s:2,trak_result:2,traker:1,transform:2,tupl:2,type:2,union:2,uniqu:2,unless:2,updat:2,us:2,util:1,uuid:2,valu:2,vector:2,vectorize_and_ignore_buff:2,veri:2,version:2,view:2,vision:2,vmap:2,want:2,we:2,weight:2,well:2,what:2,when:2,where:2,whether:2,which:2,wise:2,without:2,write:2,x:2,xtx:2,y:2,ye:2,you:2,your:2,z:2,z_i:2},titles:["Welcome to TRAK\u2019s documentation!","trak","trak package"],titleterms:{content:2,document:0,gradient_comput:2,indic:0,modelout_funct:2,modul:2,packag:2,projector:2,s:0,saver:2,score_comput:2,submodul:2,tabl:0,trak:[0,1,2],traker:2,util:2,welcom:0}})