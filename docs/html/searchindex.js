Search.setIndex({docnames:["clip","index","install","modules","quickstart","slurm","trak"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["clip.rst","index.rst","install.rst","modules.rst","quickstart.rst","slurm.rst","trak.rst"],objects:{"":[[6,0,0,"-","trak"]],"trak.gradient_computers":[[6,1,1,"","AbstractGradientComputer"],[6,1,1,"","FunctionalGradientComputer"],[6,1,1,"","IterativeGradientComputer"]],"trak.gradient_computers.AbstractGradientComputer":[[6,2,1,"","compute_loss_grad"],[6,2,1,"","compute_per_sample_grad"],[6,3,1,"","is_functional"],[6,2,1,"","load_model_params"]],"trak.gradient_computers.FunctionalGradientComputer":[[6,2,1,"","compute_loss_grad"],[6,2,1,"","compute_per_sample_grad"],[6,2,1,"","load_model_params"]],"trak.gradient_computers.IterativeGradientComputer":[[6,2,1,"","compute_loss_grad"],[6,2,1,"","compute_per_sample_grad"],[6,3,1,"","is_functional"],[6,2,1,"","load_model_params"]],"trak.modelout_functions":[[6,1,1,"","AbstractModelOutput"],[6,1,1,"","CLIPModelOutput"],[6,1,1,"","ImageClassificationModelOutput"],[6,1,1,"","IterImageClassificationModelOutput"]],"trak.modelout_functions.AbstractModelOutput":[[6,2,1,"","get_out_to_loss_grad"],[6,2,1,"","get_output"]],"trak.modelout_functions.CLIPModelOutput":[[6,2,1,"","get_embeddings"],[6,2,1,"","get_out_to_loss_grad"],[6,2,1,"","get_output"],[6,3,1,"","image_embeddings"],[6,3,1,"","num_computed_embeddings"],[6,3,1,"","sim_batch_size"],[6,3,1,"","text_embeddings"]],"trak.modelout_functions.ImageClassificationModelOutput":[[6,2,1,"","forward"],[6,2,1,"","get_out_to_loss_grad"],[6,2,1,"","get_output"]],"trak.modelout_functions.IterImageClassificationModelOutput":[[6,2,1,"","get_out_to_loss_grad"],[6,2,1,"","get_output"]],"trak.projectors":[[6,1,1,"","AbstractProjector"],[6,1,1,"","BasicProjector"],[6,1,1,"","BasicSingleBlockProjector"],[6,1,1,"","CudaProjector"],[6,1,1,"","ProjectionType"]],"trak.projectors.AbstractProjector":[[6,2,1,"","project"]],"trak.projectors.BasicProjector":[[6,2,1,"","generate_sketch_matrix"],[6,2,1,"","get_generator_states"],[6,2,1,"","project"]],"trak.projectors.BasicSingleBlockProjector":[[6,2,1,"","generate_sketch_matrix"],[6,2,1,"","project"]],"trak.projectors.CudaProjector":[[6,2,1,"","project"]],"trak.projectors.ProjectionType":[[6,3,1,"","normal"],[6,3,1,"","rademacher"]],"trak.savers":[[6,1,1,"","AbstractSaver"],[6,1,1,"","MmapSaver"],[6,4,1,"","ModelIDException"]],"trak.savers.AbstractSaver":[[6,2,1,"","clear_target_grad_count"],[6,2,1,"","del_grads"],[6,2,1,"","load_store"],[6,2,1,"","load_target_store"],[6,2,1,"","register_model_id"],[6,2,1,"","serialize_model_id_metadata"]],"trak.savers.MmapSaver":[[6,2,1,"","clear_target_grad_count"],[6,2,1,"","del_grads"],[6,2,1,"","init_store"],[6,2,1,"","load_store"],[6,2,1,"","load_target_store"],[6,2,1,"","register_model_id"],[6,2,1,"","save_scores"],[6,2,1,"","serialize_model_id_metadata"]],"trak.score_computers":[[6,1,1,"","AbstractScoreComputer"],[6,1,1,"","BasicScoreComputer"],[6,1,1,"","BasicSingleBlockScoreComputer"]],"trak.score_computers.AbstractScoreComputer":[[6,2,1,"","get_scores"],[6,2,1,"","get_x_xtx_inv"],[6,2,1,"","get_xtx"]],"trak.score_computers.BasicScoreComputer":[[6,2,1,"","get_scores"],[6,2,1,"","get_x_xtx_inv"],[6,2,1,"","get_xtx"]],"trak.score_computers.BasicSingleBlockScoreComputer":[[6,2,1,"","get_scores"],[6,2,1,"","get_x_xtx_inv"],[6,2,1,"","get_xtx"]],"trak.traker":[[6,1,1,"","TRAKer"]],"trak.traker.TRAKer":[[6,2,1,"","featurize"],[6,2,1,"","finalize_features"],[6,2,1,"","finalize_scores"],[6,2,1,"","init_projector"],[6,2,1,"","load_checkpoint"],[6,2,1,"","score"],[6,2,1,"","start_scoring_checkpoint"]],"trak.utils":[[6,5,1,"","get_num_params"],[6,5,1,"","get_params_dict"],[6,5,1,"","is_not_buffer"],[6,5,1,"","parameters_to_vector"],[6,5,1,"","vectorize_and_ignore_buffers"]],trak:[[6,0,0,"-","gradient_computers"],[6,0,0,"-","modelout_functions"],[6,0,0,"-","projectors"],[6,0,0,"-","savers"],[6,0,0,"-","score_computers"],[6,0,0,"-","traker"],[6,0,0,"-","utils"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","exception","Python exception"],"5":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:exception","5":"py:function"},terms:{"0":[1,2,6],"1":[2,6],"10":2,"100":6,"100000":6,"1024":6,"11":2,"12":2,"2":6,"200":6,"2048":6,"3":6,"300":6,"4":6,"5":[2,6],"50000":6,"50_000":6,"64":[],"7":[2,6],"9":[],"abstract":6,"break":6,"case":2,"class":6,"default":[2,6],"do":6,"enum":6,"export":2,"final":6,"float":6,"function":6,"int":6,"new":6,"return":6,"static":6,"true":6,A:6,At:[],For:[2,6],If:[2,6],In:6,It:6,On:2,Or:[],The:[2,6],These:6,To:2,_:6,_allow_featurizing_already_regist:6,_description_:6,_summary_:6,a100:6,abc:6,about:6,abov:6,abstractgradientcomput:6,abstractmodeloutput:6,abstractprojector:6,abstractsav:6,abstractscorecomput:6,accumul:6,across:6,action:[],activ:1,ad:6,add:2,addit:6,addition:6,all:6,allow:6,almost:6,alon:6,along:6,alongsid:2,alreadi:[2,6],also:6,an:[2,6],analyt:6,ani:6,anyth:6,appli:6,applic:6,apt:2,ar:[1,2,6],arg:6,arrai:6,assertionerror:6,associ:6,attribut:6,autograd:6,avail:[2,6],avoid:6,b:6,backward:6,bare:6,base:6,bash:[],basicprojector:6,basicscorecomput:6,basicsingleblockprojector:6,basicsingleblockscorecomput:6,batch:6,batch_siz:6,been:2,befor:[2,6],behavior:6,behaviour:6,below:2,big:6,block:6,block_siz:6,bone:6,bool:6,both:6,buffer:6,c:[2,6],call:6,can:[2,6],cannot:6,capabl:6,caption:6,cc:2,cdot:6,chang:1,check:[2,6],checkpoint:6,choic:6,chosen:6,classif:6,clear_target_grad_count:6,clip:[1,6],clipmodeloutput:6,cluster:2,coda:[],code:[],com:[2,6],come:2,command:2,comment:[],commit:6,compani:2,compat:[2,6],compil:2,comput:6,compute_loss_grad:6,compute_per_sample_grad:6,conda:2,confid:2,configur:2,confus:6,consid:6,contain:2,content:[1,3],context:6,contrast:6,correct:6,count:6,crawler:[],creat:6,cuda:[1,6],cuda_max_dim_s:6,cudaprojector:6,cudatoolkit:2,current_:6,custom:[2,6],cxx:2,data:6,del_grad:6,delet:6,deriv:6,design:6,desir:6,detail:6,determin:6,dev:2,develop:[1,6],devic:6,diagon:6,dict:6,dictionari:6,differ:6,dimens:6,dimension:6,dir:6,disk:6,doc:[2,6],document:2,doe:6,doesn:6,don:6,done:2,doubt:2,download:2,dtype:6,dure:6,e:6,each:6,easy_instal:[],either:6,ell:6,embed:6,embedding_dim:6,enabl:[2,6],entir:6,entri:6,enumer:6,equival:6,error:6,etc:6,even:6,everi:6,exampl:[1,2,6],except:6,exist:[2,6],exp_nam:6,f:6,fals:6,faq:1,fast:2,faster:6,feasibl:6,featur:6,feel:[2,6],file:6,finalize_featur:6,finalize_scor:6,fix:6,flatten:6,float16:6,float32:6,follow:[2,6],footprint:6,forbidden:6,forg:2,forward:6,frac:6,free:6,from:6,func:6,func_model:6,functionalgradientcomput:6,functorch:6,g:[2,6],gcc:1,gcc_linux:[],gener:6,generate_sketch_matrix:6,generator_st:6,get_embed:6,get_generator_st:6,get_num_param:6,get_out_to_loss_grad:6,get_output:6,get_params_dict:6,get_scor:6,get_x_xtx_inv:6,get_xtx:6,getter:6,given:6,gnu:[],good:6,gpu:6,grad:6,grad_dim:6,grad_out_to_loss:6,grad_w0:6,grad_w1:6,grad_wi:6,grad_wp:6,gradient:6,gradient_comput:[1,3],gradientcomput:6,grads_shap:[],guid:2,gxx_linux:[],ha:[2,6],handl:6,happen:2,have:[2,6],henc:6,here:[2,6],heta:6,how:[1,6],html:[2,6],http:[2,6],hyperparamet:6,i:6,id:6,imag:6,image_embed:6,imageclassificationmodeloutput:6,implement:6,includ:6,incompat:2,ind:6,index:[1,2],indic:6,ineffici:6,init:6,init_projector:6,init_stor:6,initi:6,input:6,instal:1,instead:6,instruct:2,intermedi:6,intern:6,invok:6,is_funct:6,is_not_buff:6,iter:6,iterativegradientcomput:6,iterimageclassificationmodeloutput:6,its:6,jl:[2,6],johnson:6,kernel:2,kwarg:6,label:6,languag:6,larger:6,last:6,learn:6,let:[2,6],leverag:6,like:6,lindenstrauss:6,line:[],link:6,linux:[],list:[2,6],littl:[],ll:6,load:[2,6],load_checkpoint:6,load_model_param:6,load_state_dict:6,load_stor:6,load_target_stor:6,loader:6,log:[2,6],logit:6,loss:6,lot:1,machin:2,mai:[1,2],maintain:2,make:6,make_functional_with_buff:6,mani:6,manner:6,map:6,margin:6,math:6,matmul:6,matric:6,matrix:6,maximum:6,memmap:6,memori:6,metadata:6,method:6,might:2,minim:6,mkvirtualenv:[],mmap:6,mmapsav:6,mode:6,model:6,model_id:6,model_out_to_loss:6,model_out_to_loss_grad:6,modelidexcept:6,modelout_fn:6,modelout_funct:[1,3],modeloutput:[1,6],modeloutputfunct:[],modifi:6,modul:[1,2],modulefil:2,more:6,most:[2,6],much:6,multiclass:6,multimod:6,must:6,n:6,nabla_:6,name:6,need:[2,6],nn:6,none:6,normal:6,notat:6,note:[2,6],notebook:6,npy:6,num_computed_embed:6,num_param:6,num_sampl:6,num_target:6,number:6,numpi:6,nvcc:1,nvidia:[2,6],object:6,old:6,one:[2,6],onli:6,oom:6,oper:2,option:[2,6],org:6,other:2,otherwis:6,our:[2,6],out:6,out_to_loss:6,outdat:2,output:6,overrid:6,p:6,packag:2,page:[],pair:6,paper:6,parallel:1,paramet:6,parameters_to_vector:6,params_dict:6,part:6,partial:6,particular:6,pass:6,path:6,pathlib:6,per:6,per_sample_grad:6,perform:6,peski:6,phi:6,phi_c:6,pick:2,pip:2,pleas:6,plese:2,popul:6,ppa:2,pr:6,predict:6,preinstal:2,prepar:6,preprocess_fn_img:6,preprocess_fn_txt:6,probabl:6,problem:6,proce:2,produc:6,proj_dim:6,proj_typ:6,project:[2,6],projectiontyp:6,projector:[1,3],provid:6,psi:6,purpos:6,pytorch:6,q:6,quick:2,r:[2,6],rademach:6,rais:6,random:6,rang:6,re:6,read:6,reason:6,recommend:6,record:6,reduct:6,refer:[2,6],regard:2,regist:6,register_model_id:6,relat:6,repositori:2,requir:[2,6],reset:6,reshap:6,resnet18:6,respect:6,result:6,reweight:6,root:2,run:[2,6],rune:2,s:[2,6],same:[2,6],sampl:6,save:6,save_dir:6,save_scor:6,saver:[1,3],scalar:6,score:[1,6],score_comput:[1,3],scorecomput:6,search:[],section:[2,6],see:[2,6],seed:6,self:6,sequenti:6,serial:6,serialize_model_id_metadata:6,set:6,setter:6,setup:2,shape:6,share:2,ship:2,should:6,shouldn:6,show:2,signatur:6,significantli:6,sim_batch_s:6,similar:6,simpl:6,simpli:6,simul:6,simulated_batch_s:6,sinc:6,siu:[],size:6,slightli:6,slower:6,slurm:1,small:6,so:6,softmax:6,some:2,someth:6,sourc:6,specifi:6,stabl:6,standard:2,start:[2,6],start_scoring_checkpoint:6,state:6,state_dict:6,step:[2,6],still:1,store:6,str:6,strongli:6,structur:6,subclass:[1,6],submodul:[],sudo:2,sum_:6,system:2,t:6,take:6,target:6,target_grad:6,task:6,temperatur:6,tensor:6,term:6,termin:2,test:[2,6],text:6,text_embed:6,than:6,thei:2,them:6,theta:6,thi:[2,6],thing:1,think:6,three:6,thu:6,ti:6,time:2,tip:2,todo:6,togeth:6,tookit:2,toolchain:2,toolkit:1,top:6,torch:6,train:6,train_set_s:6,trak:3,trak_result:6,traker:[1,2,3],transform:6,tupl:6,type:6,ubuntu:2,under:1,union:6,uniqu:6,unless:6,unvers:2,updat:[2,6],us:[2,6],usual:2,util:[1,3],uuid:6,valu:6,vector:6,vectorize_and_ignore_buff:6,veri:6,version:[1,2,6],view:6,virtualenvwrapp:[],vision:6,vmap:6,wai:2,want:6,we:[1,6],weight:6,well:6,what:[2,6],when:[2,6],where:6,whether:6,which:[2,6],wise:6,without:[2,6],write:6,x86_64:[],x:[1,6],xtx:6,y:6,ye:6,you:[2,6],your:[2,6],z:6,z_i:6},titles:["Subclassing <code class=\"code docutils literal notranslate\"><span class=\"pre\">ModelOutput</span></code> \u2014 Example with CLIP","Welcome to TRAK\u2019s documentation!","Installation FAQs","Module index","&lt;no title&gt;","Parallelize <code class=\"code docutils literal notranslate\"><span class=\"pre\">TRAK</span></code> scoring with <code class=\"code docutils literal notranslate\"><span class=\"pre\">SLURM</span></code>","Modules"],titleterms:{"class":[],clip:0,content:6,cuda:2,document:1,exampl:0,faq:2,gcc:2,gradient_comput:6,how:2,index:3,indic:1,instal:2,intro:[],modelout_funct:6,modeloutput:0,modeloutputfunct:[],modul:[3,6],nvcc:2,packag:[],parallel:5,projector:6,s:1,saver:6,score:5,score_comput:6,slurm:5,subclass:0,submodul:[],tabl:1,toolkit:2,trak:[1,2,5,6],traker:6,util:6,welcom:1}})