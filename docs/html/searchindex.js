Search.setIndex({docnames:["index","install","modules","trak"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["index.rst","install.rst","modules.rst","trak.rst"],objects:{"":[[3,0,0,"-","trak"]],"trak.gradient_computers":[[3,1,1,"","AbstractGradientComputer"],[3,1,1,"","FunctionalGradientComputer"],[3,1,1,"","IterativeGradientComputer"]],"trak.gradient_computers.AbstractGradientComputer":[[3,2,1,"","compute_loss_grad"],[3,2,1,"","compute_per_sample_grad"],[3,3,1,"","is_functional"],[3,2,1,"","load_model_params"]],"trak.gradient_computers.FunctionalGradientComputer":[[3,2,1,"","compute_loss_grad"],[3,2,1,"","compute_per_sample_grad"],[3,2,1,"","load_model_params"]],"trak.gradient_computers.IterativeGradientComputer":[[3,2,1,"","compute_loss_grad"],[3,2,1,"","compute_per_sample_grad"],[3,3,1,"","is_functional"],[3,2,1,"","load_model_params"]],"trak.modelout_functions":[[3,1,1,"","AbstractModelOutput"],[3,1,1,"","CLIPModelOutput"],[3,1,1,"","ImageClassificationModelOutput"],[3,1,1,"","IterImageClassificationModelOutput"]],"trak.modelout_functions.AbstractModelOutput":[[3,2,1,"","get_out_to_loss_grad"],[3,2,1,"","get_output"]],"trak.modelout_functions.CLIPModelOutput":[[3,2,1,"","get_embeddings"],[3,2,1,"","get_out_to_loss_grad"],[3,2,1,"","get_output"],[3,3,1,"","image_embeddings"],[3,3,1,"","num_computed_embeddings"],[3,3,1,"","sim_batch_size"],[3,3,1,"","text_embeddings"]],"trak.modelout_functions.ImageClassificationModelOutput":[[3,2,1,"","forward"],[3,2,1,"","get_out_to_loss_grad"],[3,2,1,"","get_output"]],"trak.modelout_functions.IterImageClassificationModelOutput":[[3,2,1,"","get_out_to_loss_grad"],[3,2,1,"","get_output"]],"trak.projectors":[[3,1,1,"","AbstractProjector"],[3,1,1,"","BasicProjector"],[3,1,1,"","BasicSingleBlockProjector"],[3,1,1,"","CudaProjector"],[3,1,1,"","ProjectionType"]],"trak.projectors.AbstractProjector":[[3,2,1,"","project"]],"trak.projectors.BasicProjector":[[3,2,1,"","generate_sketch_matrix"],[3,2,1,"","get_generator_states"],[3,2,1,"","project"]],"trak.projectors.BasicSingleBlockProjector":[[3,2,1,"","generate_sketch_matrix"],[3,2,1,"","project"]],"trak.projectors.CudaProjector":[[3,2,1,"","project"]],"trak.projectors.ProjectionType":[[3,3,1,"","normal"],[3,3,1,"","rademacher"]],"trak.savers":[[3,1,1,"","AbstractSaver"],[3,1,1,"","MmapSaver"],[3,4,1,"","ModelIDException"]],"trak.savers.AbstractSaver":[[3,2,1,"","clear_target_grad_count"],[3,2,1,"","del_grads"],[3,2,1,"","load_store"],[3,2,1,"","load_target_store"],[3,2,1,"","register_model_id"],[3,2,1,"","serialize_model_id_metadata"]],"trak.savers.MmapSaver":[[3,2,1,"","clear_target_grad_count"],[3,2,1,"","del_grads"],[3,2,1,"","init_store"],[3,2,1,"","load_store"],[3,2,1,"","load_target_store"],[3,2,1,"","register_model_id"],[3,2,1,"","save_scores"],[3,2,1,"","serialize_model_id_metadata"]],"trak.score_computers":[[3,1,1,"","AbstractScoreComputer"],[3,1,1,"","BasicScoreComputer"],[3,1,1,"","BasicSingleBlockScoreComputer"]],"trak.score_computers.AbstractScoreComputer":[[3,2,1,"","get_scores"],[3,2,1,"","get_x_xtx_inv"],[3,2,1,"","get_xtx"]],"trak.score_computers.BasicScoreComputer":[[3,2,1,"","get_scores"],[3,2,1,"","get_x_xtx_inv"],[3,2,1,"","get_xtx"]],"trak.score_computers.BasicSingleBlockScoreComputer":[[3,2,1,"","get_scores"],[3,2,1,"","get_x_xtx_inv"],[3,2,1,"","get_xtx"]],"trak.traker":[[3,1,1,"","TRAKer"]],"trak.traker.TRAKer":[[3,2,1,"","featurize"],[3,2,1,"","finalize_features"],[3,2,1,"","finalize_scores"],[3,2,1,"","init_projector"],[3,2,1,"","load_checkpoint"],[3,2,1,"","score"],[3,2,1,"","start_scoring_checkpoint"]],"trak.utils":[[3,5,1,"","get_num_params"],[3,5,1,"","get_params_dict"],[3,5,1,"","is_not_buffer"],[3,5,1,"","parameters_to_vector"],[3,5,1,"","vectorize_and_ignore_buffers"]],trak:[[3,0,0,"-","gradient_computers"],[3,0,0,"-","modelout_functions"],[3,0,0,"-","projectors"],[3,0,0,"-","savers"],[3,0,0,"-","score_computers"],[3,0,0,"-","traker"],[3,0,0,"-","utils"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","exception","Python exception"],"5":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:exception","5":"py:function"},terms:{"0":[1,3],"1":3,"10":1,"100":3,"100000":3,"1024":3,"11":1,"12":1,"2":3,"200":3,"2048":3,"3":[1,3],"300":3,"4":3,"5":[1,3],"50000":3,"50_000":3,"64":1,"7":[1,3],"9":1,"abstract":3,"break":3,"case":1,"class":3,"default":[1,3],"do":3,"enum":3,"export":1,"final":3,"float":3,"function":3,"int":3,"new":3,"return":3,"static":3,"true":3,A:3,At:[],For:[1,3],If:[1,3],In:3,It:3,On:1,Or:[],The:[1,3],These:3,To:1,_:3,_allow_featurizing_already_regist:3,_description_:3,_summary_:3,a100:3,abc:3,about:3,abov:3,abstractgradientcomput:3,abstractmodeloutput:3,abstractprojector:3,abstractsav:3,abstractscorecomput:3,accumul:3,across:3,ad:3,add:1,addit:3,addition:3,all:3,allow:3,almost:3,alon:3,along:3,alongsid:1,alreadi:[1,3],also:3,an:[1,3],analyt:3,ani:3,anyth:3,appli:3,applic:3,apt:1,ar:[1,3],arg:3,arrai:3,assertionerror:3,associ:3,attribut:3,autograd:3,avail:[1,3],avoid:3,b:3,backward:3,bare:3,base:3,basicprojector:3,basicscorecomput:3,basicsingleblockprojector:3,basicsingleblockscorecomput:3,batch:3,batch_siz:3,been:1,befor:[1,3],behavior:3,behaviour:3,below:1,big:3,block:3,block_siz:3,bone:3,bool:3,both:3,buffer:3,c:[1,3],call:3,can:[1,3],cannot:3,capabl:3,caption:3,cc:1,cdot:3,check:[1,3],checkpoint:3,choic:3,chosen:3,classif:3,clear_target_grad_count:3,clip:3,clipmodeloutput:3,cluster:1,coda:1,code:[],com:[1,3],come:1,command:1,commit:3,compani:1,compat:[1,3],compil:1,comput:3,compute_loss_grad:3,compute_per_sample_grad:3,conda:1,confid:1,configur:1,confus:3,consid:3,contain:1,content:2,context:3,contrast:3,correct:3,count:3,crawler:[],creat:3,cuda:[0,3],cuda_max_dim_s:3,cudaprojector:3,cudatoolkit:1,current_:3,custom:[1,3],cxx:1,data:3,del_grad:3,delet:3,deriv:3,design:3,desir:3,detail:3,determin:3,dev:1,develop:3,devic:3,diagon:3,dict:3,dictionari:3,differ:3,dimens:3,dimension:3,dir:3,disk:3,doc:[1,3],document:1,doe:3,doesn:3,don:3,done:1,doubt:1,download:1,dtype:3,dure:3,e:3,each:3,easy_instal:[],either:3,ell:3,embed:3,embedding_dim:3,enabl:[1,3],entir:3,entri:3,enumer:3,equival:3,error:3,etc:3,even:3,everi:3,exampl:[1,3],except:3,exist:[1,3],exp_nam:3,f:3,fals:3,faq:0,fast:1,faster:3,feasibl:3,featur:3,feel:[1,3],file:3,finalize_featur:3,finalize_scor:3,fix:3,flatten:3,float16:3,float32:3,follow:[1,3],footprint:3,forbidden:3,forg:1,forward:3,frac:3,free:3,from:3,func:3,func_model:3,functionalgradientcomput:3,functorch:3,g:[1,3],gcc:0,gcc_linux:1,gener:3,generate_sketch_matrix:3,generator_st:3,get_embed:3,get_generator_st:3,get_num_param:3,get_out_to_loss_grad:3,get_output:3,get_params_dict:3,get_scor:3,get_x_xtx_inv:3,get_xtx:3,getter:3,given:3,gnu:1,good:3,gpu:3,grad:3,grad_dim:3,grad_out_to_loss:3,grad_w0:3,grad_w1:3,grad_wi:3,grad_wp:3,gradient:3,gradient_comput:2,gradientcomput:3,grads_shap:[],guid:1,gxx_linux:1,ha:[1,3],handl:3,happen:1,have:[1,3],henc:3,here:[1,3],heta:3,how:[0,3],html:[1,3],http:[1,3],hyperparamet:3,i:3,id:3,imag:3,image_embed:3,imageclassificationmodeloutput:3,implement:3,includ:3,incompat:1,ind:3,index:[0,1],indic:3,ineffici:3,init:3,init_projector:3,init_stor:3,initi:3,input:3,instal:0,instead:3,instruct:1,intermedi:3,intern:3,invok:3,is_funct:3,is_not_buff:3,iter:3,iterativegradientcomput:3,iterimageclassificationmodeloutput:3,its:3,jl:[1,3],johnson:3,kernel:1,kwarg:3,label:3,languag:3,larger:3,last:3,learn:3,let:[1,3],leverag:3,like:3,lindenstrauss:3,line:[],link:3,linux:1,list:[1,3],ll:3,load:[1,3],load_checkpoint:3,load_model_param:3,load_state_dict:3,load_stor:3,load_target_stor:3,loader:3,log:[1,3],logit:3,loss:3,machin:1,maintain:1,make:3,make_functional_with_buff:3,mani:3,manner:3,map:3,margin:3,math:3,matmul:3,matric:3,matrix:3,maximum:3,memmap:3,memori:3,metadata:3,method:3,might:1,minim:3,mkvirtualenv:[],mmap:3,mmapsav:3,mode:3,model:3,model_id:3,model_out_to_loss:3,model_out_to_loss_grad:3,modelidexcept:3,modelout_fn:3,modelout_funct:2,modeloutput:3,modifi:3,modul:[0,1,2],modulefil:1,more:3,most:[1,3],much:3,multiclass:3,multimod:3,must:3,n:3,nabla_:3,name:3,need:[1,3],nn:3,none:3,normal:3,notat:3,note:3,notebook:3,npy:3,num_computed_embed:3,num_param:3,num_sampl:3,num_target:3,number:3,numpi:3,nvcc:0,nvidia:[1,3],object:3,old:3,one:[1,3],onli:3,oom:3,oper:1,option:[1,3],org:3,other:1,otherwis:3,our:[1,3],out:3,out_to_loss:3,output:3,overrid:3,p:3,packag:[0,1,2],page:0,pair:3,paper:3,paramet:3,parameters_to_vector:3,params_dict:3,part:3,partial:3,particular:3,pass:3,path:3,pathlib:3,per:3,per_sample_grad:3,perform:3,peski:3,phi:3,phi_c:3,pick:1,pip:1,pleas:3,plese:1,popul:3,ppa:1,pr:3,predict:3,preinstal:1,prepar:3,preprocess_fn_img:3,preprocess_fn_txt:3,probabl:3,problem:3,proce:1,produc:3,proj_dim:3,proj_typ:3,project:[1,3],projectiontyp:3,projector:2,provid:3,psi:3,purpos:3,pytorch:3,q:3,quick:1,r:[1,3],rademach:3,rais:3,random:3,rang:3,re:3,read:3,reason:3,recommend:3,record:3,reduct:3,refer:[1,3],regard:1,regist:3,register_model_id:3,relat:3,repositori:1,requir:[1,3],reset:3,reshap:3,resnet18:3,respect:3,result:3,reweight:3,root:1,run:[1,3],rune:1,s:[1,3],same:[1,3],sampl:3,save:3,save_dir:3,save_scor:3,saver:2,scalar:3,score:3,score_comput:2,scorecomput:3,search:0,section:[1,3],see:[1,3],seed:3,self:3,sequenti:3,serial:3,serialize_model_id_metadata:3,set:3,setter:3,setup:1,shape:3,share:1,ship:1,should:3,shouldn:3,show:1,signatur:3,significantli:3,sim_batch_s:3,similar:3,simpl:3,simpli:3,simul:3,simulated_batch_s:3,sinc:3,size:3,slightli:3,slower:3,small:3,so:3,softmax:3,some:1,someth:3,sourc:3,specifi:3,stabl:3,standard:1,start:[1,3],start_scoring_checkpoint:3,state:3,state_dict:3,step:[1,3],store:3,str:3,strongli:3,structur:3,subclass:3,submodul:2,sudo:1,sum_:3,system:1,t:3,take:3,target:3,target_grad:3,task:3,temperatur:3,tensor:3,term:3,termin:1,test:[1,3],text:3,text_embed:3,than:3,thei:1,them:3,theta:3,thi:[1,3],think:3,three:3,thu:3,ti:3,time:1,tip:1,todo:3,togeth:3,tookit:1,toolchain:1,toolkit:0,top:3,torch:3,train:3,train_set_s:3,trak:2,trak_result:3,traker:[1,2],transform:3,tupl:3,type:3,ubuntu:1,union:3,uniqu:3,unless:3,unvers:1,updat:[1,3],us:[1,3],usual:1,util:2,uuid:3,valu:3,vector:3,vectorize_and_ignore_buff:3,veri:3,version:[1,3],view:3,virtualenvwrapp:[],vision:3,vmap:3,wai:1,want:3,we:3,weight:3,well:3,what:[1,3],when:[1,3],where:3,whether:3,which:[1,3],wise:3,without:[1,3],write:3,x86_64:1,x:3,xtx:3,y:3,ye:3,you:[1,3],your:[1,3],z:3,z_i:3},titles:["Welcome to TRAK\u2019s documentation!","Installation FAQs","Index","trak package"],titleterms:{content:3,cuda:1,document:0,faq:1,gcc:1,gradient_comput:3,how:1,index:2,indic:0,instal:1,modelout_funct:3,modul:3,nvcc:1,packag:3,projector:3,s:0,saver:3,score_comput:3,submodul:3,tabl:0,toolkit:1,trak:[0,1,3],traker:3,util:3,welcom:0}})