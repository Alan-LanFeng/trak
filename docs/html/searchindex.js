Search.setIndex({"docnames": ["bert", "clip", "index", "install", "quickstart", "slurm", "trak"], "filenames": ["bert.rst", "clip.rst", "index.rst", "install.rst", "quickstart.rst", "slurm.rst", "trak.rst"], "titles": ["Add  a <code class=\"code docutils literal notranslate\"><span class=\"pre\">task</span></code> to <code class=\"code docutils literal notranslate\"><span class=\"pre\">TRAKer</span></code> (subclassing <code class=\"code docutils literal notranslate\"><span class=\"pre\">ModelOutput</span></code>) \u2014 BERT-base", "Add  a <code class=\"code docutils literal notranslate\"><span class=\"pre\">task</span></code> to <code class=\"code docutils literal notranslate\"><span class=\"pre\">TRAKer</span></code> (subclassing <code class=\"code docutils literal notranslate\"><span class=\"pre\">ModelOutput</span></code>) \u2014 CLIP", "TRAK: Attributing Model Behavior at Scale", "Installation FAQs", "Quickstart \u2014 get <code class=\"code docutils literal notranslate\"><span class=\"pre\">TRAK</span></code> scores for <code class=\"code docutils literal notranslate\"><span class=\"pre\">CIFAR</span></code>", "Parallelize <code class=\"code docutils literal notranslate\"><span class=\"pre\">TRAK</span></code> scoring with <code class=\"code docutils literal notranslate\"><span class=\"pre\">SLURM</span></code>", "API reference"], "terms": {"come": [0, 1, 2, 3], "soon": 0, "In": [1, 4, 5, 6], "thi": [1, 2, 3, 4, 5, 6], "tutori": [1, 4, 6], "ll": [1, 3, 4, 5, 6], "go": [1, 4, 5], "through": 1, "process": [1, 4, 5], "appli": [1, 2, 4, 6], "custom": [1, 2, 3, 4, 6], "us": [1, 2, 3, 4, 5, 6], "an": [1, 2, 3, 4, 6], "exampl": [1, 3, 5, 6], "check": [1, 2, 3, 4, 5, 6], "out": [1, 4, 5, 6], "clipmodeloutput": [1, 6], "final": [1, 4, 6], "result": [1, 5, 6], "comput": [1, 5, 6], "attribut": [1, 6], "score": [1, 2, 6], "requir": [1, 3, 4, 5, 6], "defin": [1, 4], "appropri": [1, 4], "guid": [1, 2, 3], "intuit": [1, 4], "can": [1, 2, 3, 4, 5, 6], "just": [1, 2, 4], "think": [1, 5, 6], "deriv": [1, 6], "discuss": 1, "multipl": [1, 4, 5, 6], "binari": 1, "multiclass": [1, 6], "classif": [1, 4, 6], "variou": 1, "nlp": 1, "etc": [1, 4, 6], "detail": [1, 2, 4, 5, 6], "our": [1, 2, 3, 4, 5, 6], "paper": [1, 2, 4, 5, 6], "short": 1, "given": [1, 4, 6], "follow": [1, 2, 3, 5, 6], "train": [1, 5, 6], "set": [1, 6], "": [1, 2, 3, 4, 5, 6], "z_1": 1, "z_2": 1, "ldot": 1, "z_n": 1, "where": [1, 6], "each": [1, 4, 6], "z_i": [1, 6], "x_i": 1, "y_i": 1, "i": [1, 2, 3, 4, 5, 6], "input": [1, 6], "label": [1, 4, 6], "pair": [1, 6], "interest": 1, "z": [1, 6], "paramet": [1, 4, 6], "theta": [1, 6], "implicitli": 1, "repres": 1, "machin": [1, 3], "learn": [1, 2, 4, 5, 6], "some": [1, 3, 4, 5], "f": [1, 4, 5, 6], "which": [1, 2, 3, 4, 6], "map": [1, 4, 5, 6], "real": 1, "number": [1, 4, 6], "One": 1, "e": [1, 2, 3, 4, 5, 6], "g": [1, 2, 3, 4, 5, 6], "cross": 1, "entropi": 1, "incur": 1, "addition": [1, 6], "estim": 1, "see": [1, 2, 3, 4, 5, 6], "algorithm": [1, 2, 4], "1": [1, 2, 3, 6], "n": [1, 4], "time": [1, 3], "diagon": [1, 6], "matrix": [1, 4, 6], "one": [1, 3, 6], "minu": 1, "correct": [1, 6], "class": [1, 6], "probabl": [1, 6], "form": 1, "from": [1, 4, 5, 6], "fact": [1, 4], "log": [1, 3, 6], "left": [1, 5, 6], "frac": [1, 6], "p": [1, 4, 6], "right": [1, 6], "have": [1, 3, 4, 5, 6], "ell": [1, 6], "wrt": 1, "partial": [1, 6], "exp": [1, 6], "If": [1, 3, 4, 6], "ar": [1, 2, 3, 4, 6], "adapt": [1, 2, 4], "more": [1, 2, 4, 5, 6], "exot": 1, "unrel": 1, "might": [1, 3, 4], "modifi": [1, 6], "accordingli": 1, "all": [1, 4, 5, 6], "experi": 1, "wa": [1, 4, 5], "necessari": 1, "provid": [1, 4, 6], "dedic": 1, "abstractmodeloutput": [1, 4, 6], "take": [1, 2, 4, 6], "care": [1, 4], "translat": 1, "torch": [1, 4, 5, 6], "modul": [1, 2, 3, 4], "instanc": [1, 4, 5, 6], "achiev": [1, 5], "via": 1, "two": [1, 4], "method": [1, 2, 4, 5, 6], "get_output": [1, 6], "get_out_to_loss_grad": [1, 6], "particular": [1, 4, 6], "batch": [1, 4, 5, 6], "b": [1, 6], "return": [1, 4, 6], "vector": [1, 6], "contain": [1, 2, 3, 4], "pass": [1, 4, 5, 6], "pytorch": [1, 2, 6], "autograd": [1, 6], "sinc": [1, 6], "applic": [1, 6], "so": [1, 4, 6], "far": 1, "could": 1, "analyt": [1, 6], "hardcod": 1, "thu": [1, 6], "avoid": [1, 6], "addit": [1, 4, 6], "find": [1, 5], "yourself": 1, "believ": 1, "unlik": 1, "situat": 1, "t": [1, 5, 6], "structur": [1, 4, 6], "well": [1, 6], "when": [1, 3, 4, 5, 6], "onli": [1, 2, 4, 5, 6], "creat": [1, 4, 6], "let": [1, 3, 4, 6], "assum": [1, 4, 6], "re": [1, 6], "familiar": 1, "work": 1, "rough": 1, "idea": [1, 5], "suffici": 1, "For": [1, 3, 4, 5, 6], "imag": [1, 4, 6], "caption": [1, 6], "x": [1, 2, 4, 6], "y": [1, 6], "denot": 1, "embed": [1, 6], "phi": [1, 6], "psi": [1, 6], "pairwis": 1, "cosin": 1, "similar": [1, 4, 6], "between": [1, 4], "text": [1, 4, 6], "s_": 1, "ij": 1, "cdot": [1, 6], "aim": 1, "maxim": 1, "ii": 1, "minim": [1, 5, 6], "neq": [1, 6], "j": [1, 4], "ell_": 1, "sum_": [1, 6], "leq": 1, "ji": 1, "end": 1, "up": 1, "choos": [1, 4], "section": [1, 3, 6], "5": [1, 3, 4, 6], "why": [1, 5], "good": [1, 6], "f_": 1, "becaus": 1, "choic": [1, 4, 6], "access": 1, "util": 1, "get_embed": [1, 6], "bit": [1, 4], "too": 1, "specif": 1, "pai": 1, "much": [1, 6], "attent": 1, "arrai": [1, 4, 5, 6], "all_img_embed": 1, "all_txt_embed": 1, "todo": [1, 4, 6], "sam": [1, 6], "explain": [1, 4], "especi": 1, "functorch": [1, 6], "stuff": 1, "now": [1, 4, 5], "readi": [1, 4], "def": [1, 4, 5], "func_model": [1, 6], "weight": [1, 4, 6], "iter": [1, 4, 6], "tensor": [1, 6], "buffer": [1, 6], "image_embed": [1, 6], "text_embed": [1, 6], "_": [1, 4, 6], "unsqueez": 1, "0": [1, 2, 3, 5, 6], "ch": 1, "multinomi": 1, "arang": [1, 4], "float": [1, 4, 6], "num_sampl": [1, 4, 6], "sim_b": 1, "replac": [1, 4], "fals": [1, 4, 6], "logsumexp": 1, "dim": 1, "sum": 1, "shape": [1, 4, 6], "should": [1, 4, 5, 6], "remov": 1, "extra": 1, "dimens": [1, 4, 6], "snippet": 1, "about": [1, 5, 6], "self": [1, 4, 6], "temp": 1, "temperatur": [1, 6], "none": [1, 4, 6], "softmax": [1, 6], "diag": 1, "2": [1, 2, 4, 6], "clone": 1, "detach": 1, "under": 2, "activ": 2, "develop": [2, 6], "we": [2, 4, 5, 6], "still": [2, 4], "version": [2, 3, 6], "lot": 2, "thing": [2, 5], "mai": [2, 3, 6], "chang": [2, 4], "base": [2, 4, 6], "api": [2, 4], "effect": 2, "effici": 2, "data": [2, 6], "gradient": [2, 6], "design": [2, 5, 6], "around": [2, 4], "principl": 2, "eas": [2, 5], "you": [2, 3, 4, 5, 6], "few": [2, 4], "line": [2, 4, 5], "code": [2, 4, 5, 6], "quickstart": 2, "speed": 2, "fast": [2, 3], "cuda": [2, 4, 6], "kernel": [2, 3], "get": [2, 3, 5, 6], "state": [2, 6], "art": 2, "bert": 2, "qnli": 2, "hour": 2, "8xa100": 2, "node": [2, 5], "simplic": 2, "lightweight": 2, "entir": [2, 4, 6], "codebas": 2, "less": 2, "than": [2, 6], "1000": 2, "It": [2, 6], "also": [2, 4, 6], "quit": 2, "modular": 2, "make": [2, 3, 4, 6], "painless": 2, "ani": [2, 4, 6], "compon": 2, "your": [2, 3, 4, 6], "need": [2, 3, 4, 5, 6], "flexibl": 2, "task": [2, 4, 5, 6], "modal": 2, "easi": 2, "how": [2, 4, 6], "clip": [2, 4, 6], "The": [2, 3, 4, 5, 6], "packag": [2, 3], "pip": [2, 3], "traker": [2, 3, 5], "To": [2, 3, 4, 5], "faq": 2, "cifar": 2, "parallel": [2, 4, 6], "slurm": [2, 4, 6], "add": [2, 3, 4], "subclass": [2, 6], "modeloutput": [2, 6], "refer": [2, 3, 4], "index": [2, 3], "host": 3, "pypi": 3, "standard": 3, "jl": [3, 6], "project": [3, 4, 6], "step": [3, 4, 6], "compil": 3, "happen": 3, "compat": [3, 6], "below": [3, 4, 5], "tip": 3, "regard": 3, "10": [3, 4, 5], "pick": 3, "option": [3, 5, 6], "alreadi": [3, 6], "been": 3, "setup": 3, "run": [3, 6], "termin": [3, 5], "exist": [3, 6], "proce": 3, "unvers": 3, "compani": 3, "share": 3, "cluster": 3, "most": [3, 6], "wai": [3, 4, 5], "enabl": [3, 6], "load": [3, 5, 6], "tookit": 3, "without": [3, 6], "On": 3, "modulefil": 3, "command": [3, 5], "avail": [3, 6], "show": [3, 4], "what": [3, 4, 5, 6], "doubt": 3, "plese": 3, "maintain": 3, "document": 3, "conda": 3, "c": [3, 6], "forg": 3, "cudatoolkit": 3, "dev": 3, "note": [3, 4, 5, 6], "outdat": 3, "root": 3, "feel": [3, 6], "confid": 3, "configur": 3, "nvidia": [3, 6], "instruct": 3, "http": [3, 4, 6], "doc": [3, 5, 6], "com": [3, 4, 6], "quick": 3, "start": [3, 4, 6], "html": [3, 6], "11": 3, "7": [3, 6], "12": 3, "oper": [3, 4], "system": [3, 5], "preinstal": 3, "case": [3, 4], "ship": 3, "incompat": 3, "thei": 3, "usual": 3, "other": 3, "alongsid": 3, "default": [3, 4, 5, 6], "here": [3, 4, 5, 6], "ubuntu": 3, "repositori": 3, "sudo": 3, "apt": 3, "ppa": 3, "toolchain": 3, "r": [3, 4, 6], "test": [3, 6], "updat": [3, 4, 6], "list": [3, 4, 6], "download": [3, 4], "befor": [3, 4, 6], "rune": 3, "ha": [3, 4, 6], "done": 3, "same": [3, 4, 5, 6], "export": 3, "cxx": 3, "cc": 3, "quickli": 3, "correctli": 3, "python": [3, 5], "m": 3, "pytest": 3, "sv": 3, "test_rademach": 3, "py": [3, 5], "depend": [3, 4], "zsh": 3, "match": 3, "found": 3, "sure": 3, "escap": 3, "squar": 3, "bracket": 3, "resnet": 4, "9": [4, 5], "while": 4, "dataset": 4, "easili": 4, "overal": [4, 5], "along": 6, "trick": [], "try": 4, "jupyt": 4, "notebook": [4, 6], "roughli": 4, "fifteen": 4, "minut": 4, "total": 4, "singl": 4, "a100": [4, 5, 6], "gpu": [4, 5, 6], "A": [4, 6], "subset": 4, "cat": 4, "dog": 4, "first": 4, "either": [4, 6], "script": [4, 5], "20": 4, "state_dict": [4, 6], "own": 4, "architectur": 4, "exact": 4, "ffcv": 4, "field": 4, "decod": 4, "import": [4, 5], "intdecod": 4, "simplergbimagedecod": 4, "loader": [4, 6], "orderopt": 4, "pipelin": 4, "transform": [4, 6], "randomhorizontalflip": 4, "cutout": 4, "randomtransl": 4, "convert": 4, "todevic": 4, "totensor": 4, "totorchimag": 4, "common": 4, "squeez": 4, "o": [4, 6], "wget": 4, "tqdm": 4, "numpi": [4, 6], "np": 4, "amp": 4, "gradscal": 4, "autocast": 4, "nn": [4, 6], "crossentropyloss": 4, "conv2d": 4, "batchnorm2d": 4, "optim": 4, "sgd": 4, "lr_schedul": 4, "torchvis": 4, "beton": 4, "www": 4, "dropbox": 4, "zn7jsp2rl09e0fh": 4, "dl": 4, "val": 4, "4p73milxxafv4cm": 4, "stat": 4, "mean": [4, 5], "125": 4, "307": 4, "122": 4, "961": 4, "113": 4, "8575": 4, "std": 4, "51": 4, "5865": 4, "50": 4, "847": 4, "255": 4, "get_dataload": 4, "batch_siz": [4, 6], "256": 4, "num_work": 4, "8": [4, 5], "split": 4, "aug_se": 4, "should_aug": 4, "true": [4, 5, 6], "indic": [4, 6], "label_pipelin": 4, "devic": [4, 6], "image_pipelin": 4, "extend": 4, "pad": 4, "fill": 4, "tupl": [4, 6], "int": [4, 5, 6], "4": [4, 6], "non_block": 4, "float32": [4, 6], "normal": [4, 6], "beton_url": 4, "beton_path": 4, "str": [4, 6], "bar": 4, "order": 4, "sequenti": [4, 6], "drop_last": 4, "seed": [4, 6], "resnet9": 4, "mul": 4, "__init__": 4, "super": 4, "forward": [4, 6], "flatten": [4, 6], "view": [4, 6], "size": [4, 6], "residu": 4, "construct_rn9": 4, "num_class": 4, "conv_bn": 4, "channels_in": 4, "channels_out": 4, "kernel_s": 4, "3": [4, 6], "stride": 4, "group": 4, "bia": 4, "relu": 4, "inplac": 4, "64": 4, "128": 4, "maxpool2d": 4, "adaptivemaxpool2d": 4, "linear": 4, "lr": 4, "epoch": 4, "100": [4, 6], "momentum": 4, "weight_decai": 4, "5e": 4, "lr_peak_epoch": 4, "label_smooth": 4, "opt": 4, "iters_per_epoch": 4, "len": [4, 5], "cyclic": 4, "triangl": 4, "interp": 4, "schedul": [4, 5], "lambdalr": 4, "__getitem__": 4, "scaler": 4, "loss_fn": 4, "ep": 4, "rang": [4, 6], "model_count": 4, "im": 4, "lab": 4, "enumer": [4, 6], "zero_grad": 4, "set_to_non": 4, "loss": [4, 6], "scale": 4, "backward": [4, 6], "makedir": 4, "exist_ok": 4, "desc": 4, "memory_format": 4, "channels_last": 4, "loader_train": [4, 5], "512": 4, "sd_": 4, "pt": [4, 5], "remain": 4, "pathlib": 4, "path": [4, 5, 6], "ckpt_file": 4, "rglob": 4, "ckpt": [4, 5], "map_loc": 4, "cpu": [4, 5], "entri": [4, 6], "point": 4, "construct": 4, "three": [4, 5, 6], "argument": 4, "string": [4, 6], "specifi": [4, 5, 6], "type": [4, 5, 6], "languag": [4, 6], "style": 4, "contrast": [4, 6], "train_set_s": [4, 5, 6], "want": [4, 6], "keep": 4, "constructor": 4, "eval": 4, "image_classif": [4, 5, 6], "10_000": 4, "000": 4, "By": 4, "metadata": [4, 6], "store": [4, 6], "trak_result": [4, 6], "overrid": [4, 6], "save_dir": [4, 5, 6], "proj_dim": [4, 6], "4096": [], "curiou": 4, "correspond": 4, "output": [4, 6], "random": [4, 6], "recommend": [4, 6], "40": 4, "object": [4, 6], "determinist": 4, "call": [4, 5, 6], "progress": [], "track": [], "model_id": [4, 5, 6], "associ": [4, 6], "uniqu": [4, 6], "load_checkpoint": [4, 5, 6], "abov": [4, 5, 6], "tell": 4, "ve": 4, "inform": 4, "doe": [4, 6], "post": [4, 5], "next": 4, "finalize_featur": [4, 5, 6], "shuffl": 4, "mani": [4, 6], "sampl": [4, 6], "altern": 4, "ind": [4, 6], "instead": [4, 5, 6], "length": 4, "within": 4, "over": 4, "significantli": [4, 6], "improv": [4, 5], "perform": [4, 5, 6], "But": [4, 5], "across": [4, 5, 6], "job": [4, 5], "do": [4, 5, 6], "init": 6, "differ": [4, 5, 6], "again": 4, "purpos": [4, 6], "valid": 4, "loader_target": 4, "interfac": [], "start_scoring_checkpoint": [4, 5, 6], "num_target": [4, 6], "finalize_scor": [4, 5, 6], "function": [4, 5, 6], "analog": 4, "Be": 4, "did": 4, "wrong": 4, "silent": 4, "fail": 4, "know": 4, "clean": 4, "robust": 4, "hash": 4, "detect": 4, "open": 4, "issu": [4, 6], "github": 4, "assert": 4, "consist": 4, "after": [], "That": [4, 5], "look": 4, "like": [4, 5, 6], "snipeet": 4, "onc": 4, "them": [4, 6], "matplotlib": 4, "pyplot": 4, "plt": 4, "min": 4, "max": 4, "figur": 4, "figsiz": 4, "imshow": 4, "permut": 4, "axi": 4, "off": 4, "print": 4, "top": [4, 6], "scorer": 4, "loader_top_scor": 4, "argsort": 4, "introduc": 4, "quantit": 4, "datamodel": 4, "predict": [4, 6], "independ": 4, "pre": 4, "scipi": 4, "spearmanr": 4, "eval_correl": 4, "tmp_path": 4, "masks_url": 4, "2nmcjaftdavyg0m": 4, "mask": 4, "npy": [4, 6], "margins_url": 4, "tc3r3c3kgna2h27": 4, "val_margin": 4, "masks_path": 4, "joinpath": 4, "boolean": 4, "num": 4, "as_tensor": 4, "mmap_mod": 4, "margins_path": 4, "margin": [4, 6], "val_ind": 4, "2000": 4, "pred": 4, "append": 4, "correl": 4, "avg": 4, "valu": [4, 6], "0629": 4, "flucut": 4, "littl": 4, "concentr": 4, "often": 5, "would": 5, "checkpoint": 6, "model": [5, 6], "help": 5, "featur": 6, "exmapl": [], "highli": 5, "paralleliz": 5, "sketch": 5, "simpl": [5, 6], "leverag": 6, "power": [], "skip": 5, "highlight": 5, "main": [4, 5, 6], "behind": 5, "write": [5, 6], "file": [5, 6], "featurize_and_scor": 5, "sbatch": 5, "gather": [], "copi": [], "everyth": 5, "argpars": 5, "argumentpars": 5, "loader_v": 5, "respect": [5, 6], "ckpt_": 5, "ds_train": 5, "__name__": 5, "__main__": 5, "parser": 5, "add_argu": 5, "arg": [5, 6], "parse_arg": 5, "bin": 5, "bash": 5, "per": [5, 6], "gre": 5, "name": [5, 6], "slurm_array_task_id": 5, "submit": 5, "u": 5, "id": [5, 6], "14": [], "don": [5, 6], "attempt": [5, 6], "current": 5, "popul": [5, 6], "intermedi": [5, 6], "combin": 5, "prioriti": 5, "definit": 5, "problem": [5, 6], "integr": 5, "distribut": 5, "load_from_save_dir": 6, "bool": 6, "abstractgradientcomput": 6, "functionalgradientcomput": 6, "abstractprojector": 6, "2048": [4, 6], "sourc": 6, "front": 6, "face": 6, "readm": 6, "usag": 6, "union": 6, "ran": 6, "accept": 6, "bert_": 6, "implement": 6, "directori": 6, "save": [4, 6], "lead": 6, "flag": 6, "cudaprojector": 6, "rademach": 6, "give": 6, "leav": 6, "link": 6, "notat": 6, "nabla_": 6, "q": 6, "term": [5, 6], "must": 6, "intern": [4, 6], "del_grad": 6, "phi_c": 6, "exp_nam": 6, "target": 6, "delet": 6, "produc": 6, "uuid": 6, "gener": 6, "init_projector": 6, "initi": [4, 6], "_allow_featurizing_already_regist": 6, "dictionari": 6, "ti": 6, "behaviour": 6, "forbidden": 6, "regist": 6, "prepar": [4, 6], "dict": 6, "modelout_fn": 6, "grad_dim": 6, "abc": 6, "gradientcomput": 6, "allow": 6, "behavior": 6, "load_model_param": 6, "load_state_dict": 6, "compute_per_sample_grad": 6, "chosen": 6, "compute_loss_grad": 6, "scalar": 6, "everi": 6, "is_funct": 6, "determin": 6, "whether": 6, "abstract": 6, "consid": 6, "alon": 6, "grad": 6, "feasibl": 6, "someth": 6, "grad_out_to_loss": 6, "model_out_to_loss_grad": 6, "vmap": 6, "org": 6, "stabl": 6, "doesn": 6, "ad": 6, "signatur": 6, "its": 6, "make_functional_with_buff": 6, "iterativegradientcomput": 6, "out_to_loss": 6, "model_out_to_loss": 6, "henc": 6, "slower": 6, "equival": 6, "veri": 6, "old": 6, "togeth": 6, "vision": 6, "imageclassificationmodeloutput": 6, "iterimageclassificationmodeloutput": 6, "These": 6, "desir": 6, "logit": 6, "context": 6, "simulated_batch_s": 6, "300": 6, "multimod": 6, "rais": 6, "assertionerror": 6, "invok": 6, "static": 6, "50000": 6, "embedding_dim": 6, "1024": 6, "preprocess_fn_img": 6, "preprocess_fn_txt": 6, "maximum": 6, "50_000": 6, "func": 6, "reweight": 6, "last": 6, "simul": 6, "faster": 6, "pleas": 6, "per_sample_grad": 6, "slightli": 6, "break": 6, "shouldn": 6, "big": 6, "read": 6, "strongli": 6, "free": 6, "pr": 6, "fix": 6, "num_computed_embed": 6, "sim_batch_s": 6, "both": 6, "new": 6, "part": 6, "confus": 6, "textclassificationmodeloutput": 6, "input_id": 6, "token_type_id": 6, "attention_mask": 6, "proj_typ": 6, "projectiontyp": 6, "includ": 6, "matric": 6, "basicprojector": 6, "block_siz": 6, "200": 6, "dtype": 6, "block": 6, "wise": 6, "accumul": 6, "larger": 6, "memori": 6, "footprint": 6, "capabl": 6, "generate_sketch_matrix": 6, "generator_st": 6, "get_generator_st": 6, "basicsingleblockprojector": 6, "float16": 6, "bare": 6, "bone": 6, "ineffici": 6, "simpli": 6, "matmul": 6, "even": 6, "resnet18": 6, "small": 6, "anyth": 6, "oom": 6, "unless": 6, "reason": 6, "cannot": 6, "kwarg": 6, "enum": 6, "abstractsav": 6, "getter": 6, "setter": 6, "handl": 6, "record": 6, "hyperparamet": 6, "dimension": 6, "reduct": 6, "johnson": 6, "lindenstrauss": 6, "clear_target_grad_count": 6, "reset": 6, "count": 6, "otherwis": 6, "load_stor": 6, "current_": 6, "load_target_stor": 6, "mode": 6, "register_model_id": 6, "serialize_model_id_metadata": 6, "disk": 6, "commit": 6, "mmapsav": 6, "dure": 6, "init_stor": 6, "memmap": 6, "serial": 6, "dir": 6, "ye": 6, "error": 6, "mmap": 6, "modelidexcept": 6, "save_scor": 6, "except": 6, "relat": 6, "abstractscorecomput": 6, "scorecomput": 6, "get_xtx": 6, "get_x_xtx_inv": 6, "get_scor": 6, "target_grad": 6, "xtx": 6, "basicscorecomput": 6, "cuda_max_dim_s": 6, "100000": 6, "manner": 6, "basicsingleblockscorecomput": 6, "almost": 6, "get_num_param": 6, "get_params_dict": 6, "is_not_buff": 6, "params_dict": 6, "parameters_to_vector": 6, "reshap": 6, "peski": 6, "vectorize_and_ignore_buff": 6, "grad_w0": 6, "grad_w1": 6, "grad_wp": 6, "grad_wi": 6, "num_param": 6, "basic": [], "attribu": 4, "integ": 4, "separ": 4, "As": 4, "increas": 4, "fortun": 5, "popular": 5, "instnac": [], "mapreduc": 5, "reduc": 5, "prior": 5, "15": 5}, "objects": {"": [[6, 0, 0, "-", "trak"]], "trak": [[6, 0, 0, "-", "gradient_computers"], [6, 0, 0, "-", "modelout_functions"], [6, 0, 0, "-", "projectors"], [6, 0, 0, "-", "savers"], [6, 0, 0, "-", "score_computers"], [6, 0, 0, "-", "traker"], [6, 0, 0, "-", "utils"]], "trak.gradient_computers": [[6, 1, 1, "", "AbstractGradientComputer"], [6, 1, 1, "", "FunctionalGradientComputer"], [6, 1, 1, "", "IterativeGradientComputer"]], "trak.gradient_computers.AbstractGradientComputer": [[6, 2, 1, "", "compute_loss_grad"], [6, 2, 1, "", "compute_per_sample_grad"], [6, 3, 1, "", "is_functional"], [6, 2, 1, "", "load_model_params"]], "trak.gradient_computers.FunctionalGradientComputer": [[6, 2, 1, "", "compute_loss_grad"], [6, 2, 1, "", "compute_per_sample_grad"], [6, 2, 1, "", "load_model_params"]], "trak.gradient_computers.IterativeGradientComputer": [[6, 2, 1, "", "compute_loss_grad"], [6, 2, 1, "", "compute_per_sample_grad"], [6, 3, 1, "", "is_functional"], [6, 2, 1, "", "load_model_params"]], "trak.modelout_functions": [[6, 1, 1, "", "AbstractModelOutput"], [6, 1, 1, "", "CLIPModelOutput"], [6, 1, 1, "", "ImageClassificationModelOutput"], [6, 1, 1, "", "IterImageClassificationModelOutput"], [6, 1, 1, "", "TextClassificationModelOutput"]], "trak.modelout_functions.AbstractModelOutput": [[6, 2, 1, "", "get_out_to_loss_grad"], [6, 2, 1, "", "get_output"]], "trak.modelout_functions.CLIPModelOutput": [[6, 2, 1, "", "get_embeddings"], [6, 2, 1, "", "get_out_to_loss_grad"], [6, 2, 1, "", "get_output"], [6, 3, 1, "", "image_embeddings"], [6, 3, 1, "", "num_computed_embeddings"], [6, 3, 1, "", "sim_batch_size"], [6, 3, 1, "", "text_embeddings"]], "trak.modelout_functions.ImageClassificationModelOutput": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "get_out_to_loss_grad"], [6, 2, 1, "", "get_output"]], "trak.modelout_functions.IterImageClassificationModelOutput": [[6, 2, 1, "", "get_out_to_loss_grad"], [6, 2, 1, "", "get_output"]], "trak.modelout_functions.TextClassificationModelOutput": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "get_out_to_loss_grad"], [6, 2, 1, "", "get_output"]], "trak.projectors": [[6, 1, 1, "", "AbstractProjector"], [6, 1, 1, "", "BasicProjector"], [6, 1, 1, "", "BasicSingleBlockProjector"], [6, 1, 1, "", "CudaProjector"], [6, 1, 1, "", "ProjectionType"]], "trak.projectors.AbstractProjector": [[6, 2, 1, "", "project"]], "trak.projectors.BasicProjector": [[6, 2, 1, "", "generate_sketch_matrix"], [6, 2, 1, "", "get_generator_states"], [6, 2, 1, "", "project"]], "trak.projectors.BasicSingleBlockProjector": [[6, 2, 1, "", "generate_sketch_matrix"], [6, 2, 1, "", "project"]], "trak.projectors.CudaProjector": [[6, 2, 1, "", "project"]], "trak.projectors.ProjectionType": [[6, 3, 1, "", "normal"], [6, 3, 1, "", "rademacher"]], "trak.savers": [[6, 1, 1, "", "AbstractSaver"], [6, 1, 1, "", "MmapSaver"], [6, 4, 1, "", "ModelIDException"]], "trak.savers.AbstractSaver": [[6, 2, 1, "", "clear_target_grad_count"], [6, 2, 1, "", "del_grads"], [6, 2, 1, "", "load_store"], [6, 2, 1, "", "load_target_store"], [6, 2, 1, "", "register_model_id"], [6, 2, 1, "", "serialize_model_id_metadata"]], "trak.savers.MmapSaver": [[6, 2, 1, "", "clear_target_grad_count"], [6, 2, 1, "", "del_grads"], [6, 2, 1, "", "init_store"], [6, 2, 1, "", "load_store"], [6, 2, 1, "", "load_target_store"], [6, 2, 1, "", "register_model_id"], [6, 2, 1, "", "save_scores"], [6, 2, 1, "", "serialize_model_id_metadata"]], "trak.score_computers": [[6, 1, 1, "", "AbstractScoreComputer"], [6, 1, 1, "", "BasicScoreComputer"], [6, 1, 1, "", "BasicSingleBlockScoreComputer"]], "trak.score_computers.AbstractScoreComputer": [[6, 2, 1, "", "get_scores"], [6, 2, 1, "", "get_x_xtx_inv"], [6, 2, 1, "", "get_xtx"]], "trak.score_computers.BasicScoreComputer": [[6, 2, 1, "", "get_scores"], [6, 2, 1, "", "get_x_xtx_inv"], [6, 2, 1, "", "get_xtx"]], "trak.score_computers.BasicSingleBlockScoreComputer": [[6, 2, 1, "", "get_scores"], [6, 2, 1, "", "get_x_xtx_inv"], [6, 2, 1, "", "get_xtx"]], "trak.traker": [[6, 1, 1, "", "TRAKer"]], "trak.traker.TRAKer": [[6, 2, 1, "", "featurize"], [6, 2, 1, "", "finalize_features"], [6, 2, 1, "", "finalize_scores"], [6, 2, 1, "", "init_projector"], [6, 2, 1, "", "load_checkpoint"], [6, 2, 1, "", "score"], [6, 2, 1, "", "start_scoring_checkpoint"]], "trak.utils": [[6, 5, 1, "", "get_num_params"], [6, 5, 1, "", "get_params_dict"], [6, 5, 1, "", "is_not_buffer"], [6, 5, 1, "", "parameters_to_vector"], [6, 5, 1, "", "vectorize_and_ignore_buffers"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:exception", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "exception", "Python exception"], "5": ["py", "function", "Python function"]}, "titleterms": {"add": [0, 1], "task": [0, 1], "traker": [0, 1, 4, 6], "subclass": [0, 1], "modeloutput": [0, 1], "bert": 0, "base": 0, "clip": 1, "model": [1, 2, 4], "output": 1, "function": 1, "The": 1, "modelout": 1, "loss": 1, "gradient": 1, "q": [1, 3], "term": 1, "how": [1, 3], "we": 1, "implement": 1, "trak": [1, 2, 3, 4, 5, 6], "what": 1, "you": 1, "need": 1, "do": 1, "new": 1, "attribut": [2, 4], "behavior": 2, "scale": 2, "overview": 2, "instal": [2, 3], "content": [2, 6], "indic": 2, "tabl": 2, "faq": 3, "nvcc": 3, "cuda": 3, "toolkit": 3, "gcc": 3, "verifi": 3, "work": 3, "misc": 3, "A": 3, "quickstart": 4, "get": 4, "score": [4, 5], "cifar": 4, "save": [], "load": 4, "checkpoint": [4, 5], "set": 4, "up": 4, "class": 4, "comput": 4, "featur": [4, 5], "train": 4, "data": 4, "target": 4, "exampl": 4, "visual": 4, "bonu": 4, "evalu": 4, "counterfactu": 4, "parallel": 5, "slurm": 5, "api": 6, "refer": 6, "modul": 6, "gradient_comput": 6, "modelout_funct": 6, "projector": 6, "saver": 6, "score_comput": 6, "util": 6, "found": 4, "1": [4, 5], "each": 5, "2": 5, "run": 5, "3": 5, "gather": 5, "final": 5, "0": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"Add  a task to TRAKer (subclassing ModelOutput) \u2014 BERT-base": [[0, "add-a-task-to-traker-subclassing-modeloutput-bert-base"]], "Add  a task to TRAKer (subclassing ModelOutput) \u2014 CLIP": [[1, "add-a-task-to-traker-subclassing-modeloutput-clip"]], "Model output functions": [[1, "model-output-functions"]], "The modelout-to-loss gradient (the Q term)": [[1, "the-modelout-to-loss-gradient-the-q-term"]], "How we implement model output functions in TRAK": [[1, "how-we-implement-model-output-functions-in-trak"]], "What you need to do for a new task": [[1, "what-you-need-to-do-for-a-new-task"]], "TRAK: Attributing Model Behavior at Scale": [[2, "trak-attributing-model-behavior-at-scale"]], "Overview": [[2, "overview"]], "Install": [[2, "install"]], "Contents": [[2, "contents"]], "Indices and tables": [[2, "indices-and-tables"]], "Installation FAQs": [[3, "installation-faqs"]], "How to install TRAK?": [[3, "how-to-install-trak"]], "How to install nvcc (CUDA toolkit)?": [[3, "how-to-install-nvcc-cuda-toolkit"]], "How to install gcc?": [[3, "how-to-install-gcc"]], "Verify that the installation worked": [[3, "verify-that-the-installation-worked"]], "Misc Q&A": [[3, "misc-q-a"]], "API reference": [[6, "api-reference"]], "trak.traker module": [[6, "module-trak.traker"]], "trak.gradient_computers module": [[6, "module-trak.gradient_computers"]], "trak.modelout_functions module": [[6, "module-trak.modelout_functions"]], "trak.projectors module": [[6, "module-trak.projectors"]], "trak.savers module": [[6, "module-trak.savers"]], "trak.score_computers module": [[6, "module-trak.score_computers"]], "trak.utils module": [[6, "module-trak.utils"]], "Module contents": [[6, "module-trak"]], "Parallelize TRAK scoring with SLURM": [[5, "parallelize-trak-scoring-with-slurm"]], "1. Featurizing each checkpoint": [[5, "featurizing-each-checkpoint"]], "2. Run featurize in parallel": [[5, "run-featurize-in-parallel"]], "3. Gather final scores": [[5, "gather-final-scores"]], "Quickstart \u2014 get TRAK scores for CIFAR": [[4, "quickstart-get-trak-scores-for-cifar"]], "0. Load model checkpoints": [[4, "load-model-checkpoints"]], "1. Set up the TRAKer class": [[4, "set-up-the-traker-class"]], "Compute TRAK features for training data": [[4, "compute-trak-features-for-training-data"]], "Compute TRAK scores for target examples": [[4, "compute-trak-scores-for-target-examples"]], "Visualize the attributions found by TRAK": [[4, "visualize-the-attributions-found-by-trak"]], "Bonus: Evaluate counterfactuals": [[4, "bonus-evaluate-counterfactuals"]]}, "indexentries": {}})